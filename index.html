<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stella Pickup Countdown</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        color: white;
        padding: 15px;
      }

      h1 {
        font-size: clamp(1.5rem, 4vw, 2.5rem);
        margin-bottom: 8px;
        text-align: center;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        animation: pulse 2s ease-in-out infinite;
      }

      .paw {
        font-size: 1.5rem;
        margin: 0 8px;
      }

      .countdown-container {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 20px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        text-align: center;
        max-width: 900px;
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .content-wrapper {
        display: flex;
        gap: 30px;
        align-items: center;
        justify-content: center;
        width: 100%;
        flex-wrap: wrap;
      }

      .countdown {
        display: flex;
        justify-content: center;
        gap: 15px;
        flex-wrap: wrap;
      }

      .time-unit {
        display: flex;
        flex-direction: column;
        align-items: center;
        min-width: 70px;
      }

      .number {
        font-size: clamp(1.5rem, 3vw, 2.2rem);
        font-weight: bold;
        background: rgba(255, 255, 255, 0.2);
        padding: 8px 12px;
        border-radius: 10px;
        min-width: 60px;
        margin-bottom: 5px;
      }

      .label {
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        opacity: 0.9;
      }

      .target-time {
        font-size: 0.95rem;
        opacity: 0.9;
        margin-top: 15px;
      }

      .complete {
        font-size: 2rem;
        animation: celebrate 1s ease-in-out infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }

      @keyframes celebrate {
        0%,
        100% {
          transform: scale(1) rotate(0deg);
        }
        25% {
          transform: scale(1.1) rotate(-5deg);
        }
        75% {
          transform: scale(1.1) rotate(5deg);
        }
      }

      .stella-video {
        max-width: 200px;
        width: 100%;
        height: auto;
        border-radius: 15px;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
        border: 3px solid rgba(255, 255, 255, 0.3);
        flex-shrink: 0;
      }

      @media (max-width: 768px) {
        .content-wrapper {
          flex-direction: column;
          gap: 15px;
        }
        .stella-video {
          max-width: 180px;
        }
      }

      @media (max-width: 480px) {
        .countdown {
          gap: 10px;
        }
        .time-unit {
          min-width: 60px;
        }
        .stella-video {
          max-width: 150px;
        }
        h1 {
          font-size: 1.3rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="countdown-container">
      <h1>
        <span class="paw">üêæ</span>
        Stella's Pickup Countdown
        <span class="paw">üêæ</span>
      </h1>

      <div class="content-wrapper">
        <video id="stella-video" class="stella-video" autoplay loop muted playsinline>
          <source src="stella.mp4" type="video/mp4">
          Your browser does not support the video tag.
        </video>

        <div>
          <div id="countdown" class="countdown">
            <div class="time-unit">
              <div class="number" id="days">--</div>
              <div class="label">Days</div>
            </div>
            <div class="time-unit">
              <div class="number" id="hours">--</div>
              <div class="label">Hours</div>
            </div>
            <div class="time-unit">
              <div class="number" id="minutes">--</div>
              <div class="label">Minutes</div>
            </div>
            <div class="time-unit">
              <div class="number" id="seconds">--</div>
              <div class="label">Seconds</div>
            </div>
          </div>

          <div id="complete" style="display: none" class="complete">
            üê∂ Time to pick up Stella! üê∂
          </div>
        </div>
      </div>

      <div class="target-time">
        Counting down to: November 30th, 12:00 PM CT
      </div>
    </div>

    <script>
      // Video autoplay for Fire TV and other restrictive browsers
      let playAttempted = false;
      let playSuccessful = false;

      // Function to attempt playing the video
      function tryPlayVideo() {
        const video = document.getElementById("stella-video");

        if (!video || playSuccessful) {
          return;
        }

        // Only attempt play if video is ready
        if (video.readyState < 3) {
          console.log("Video not ready yet, readyState:", video.readyState);
          return;
        }

        if (playAttempted) {
          console.log("Play already attempted, skipping duplicate attempt");
          return;
        }

        playAttempted = true;
        console.log("Attempting to play video...");

        const playPromise = video.play();
        if (playPromise !== undefined) {
          playPromise
            .then(() => {
              console.log("Video autoplay started successfully");
              playSuccessful = true;
            })
            .catch((error) => {
              console.log("Autoplay prevented:", error);
              playAttempted = false; // Reset so we can try again
              // Try again after a short delay
              setTimeout(tryPlayVideo, 1000);
            });
        }
      }

      // Wait for DOM to be ready, then set up video event listeners
      function initVideo() {
        const video = document.getElementById("stella-video");

        if (!video) {
          console.log("Video element not found, retrying...");
          setTimeout(initVideo, 100);
          return;
        }

        console.log("Video element found, setting up listeners");

        // When video metadata is loaded
        video.addEventListener("loadedmetadata", () => {
          console.log("Video metadata loaded");
          tryPlayVideo();
        });

        // When video can start playing
        video.addEventListener("canplay", () => {
          console.log("Video can play");
          tryPlayVideo();
        });

        // When video is fully loaded and can play through
        video.addEventListener("canplaythrough", () => {
          console.log("Video can play through");
          tryPlayVideo();
        });

        // If video is already ready, try immediately
        if (video.readyState >= 3) {
          console.log("Video already ready");
          tryPlayVideo();
        }
      }

      // Start initialization when DOM is ready
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", initVideo);
      } else {
        initVideo();
      }

      // Target: November 30th, 2025, 12:00 PM Central Time
      // Note: Using 2025 since we're past Nov 30, 2024
      const targetDate = new Date("2025-11-30T12:00:00-06:00");

      function updateCountdown() {
        const now = new Date();
        const difference = targetDate - now;

        if (difference <= 0) {
          document.getElementById("countdown").style.display = "none";
          document.getElementById("complete").style.display = "block";
          return;
        }

        const days = Math.floor(difference / (1000 * 60 * 60 * 24));
        const hours = Math.floor(
          (difference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
        );
        const minutes = Math.floor(
          (difference % (1000 * 60 * 60)) / (1000 * 60)
        );
        const seconds = Math.floor((difference % (1000 * 60)) / 1000);

        document.getElementById("days").textContent = days
          .toString()
          .padStart(2, "0");
        document.getElementById("hours").textContent = hours
          .toString()
          .padStart(2, "0");
        document.getElementById("minutes").textContent = minutes
          .toString()
          .padStart(2, "0");
        document.getElementById("seconds").textContent = seconds
          .toString()
          .padStart(2, "0");
      }

      // Update immediately and then every second
      updateCountdown();
      setInterval(updateCountdown, 1000);
    </script>
  </body>
</html>
